<!doctype html>
<html lang="es">

<%- include("head"); %>
    <%- include("style_login"); %>

        <body id="body" name="body">
            <main>
                <div>

                    <head>
                        <meta charset='utf-8'>
                        <meta name='viewport' content='width=device-width, initial-scale=1'>
                        <title>BIPS lOGIN</title>
                    </head>
                    <nav class="navbar navbar-expand-md fixed-top" id="myTab" role="tablist">

                        <a class="navbar-brand" href="#">
                            <img alt="Brand" src="recursos_marca">
                        </a>
                        <a class="navbar-brand" href="#">
                            <img alt="Brand" src="recursos_it">
                        </a>
                    </nav>

                    <div class="card card0 border-0">
                        <div class="row d-flex">
                            <div class="col-lg-4">
                                <div class="card1">

                                    <!-- <div class="row px-3 justify-content-center mt-4 mb-5 border-line"> <img src="/recursos_it" class="image"> </div>-->
                                </div>
                            </div>
                            <div class="col-lg-4">


                                <div class="card2 card border-0 px-4 py-5">

                                    <!--<img style="display: block; ;" src="recursos_it">-->
                                    <!--<img style="display: block; ;" src="recursos_it"> -->

                                </div>
                                <small class="or text-center">
                                    <h4> Iniciar Sesion </h4>
                                </small>

                                <% const m=getMessages() %>

                                    <% if (m.error) { %>
                                        <div id="notificacion_login">
                                            <button class="btn-cerrar-err close" id="btn-cerrar-noti-login" data-dismiss="alert" aria-label="close">&times;</button>
                                            <div class="card-header text-white text-center bg-danger">
                                                <strong>Error!</strong>

                                                <% m.error.forEach((element)=> { %>

                                                    <%= element %>
                                                        <% }) %> %>
                                            </div>
                                        </div>

                                        <% } %>
                                            <form id="form_login" enctype="multipart/form-data" method="post">

                                                <div class="row px-3"> <label class="mb-1">
                                                        <h6 class="mb-0 text-sm">Usuario</h6>
                                                    </label> <input class="mb-4" type="text" name="username" id="username" placeholder="ingresa el nombre de usuario">
                                                </div>
                                                <div class="row px-3"> <label class="mb-1">
                                                        <h6 class="mb-0 text-sm">Contraseña</h6>
                                                    </label> <input type="password" name="password" id="password" placeholder="Ingresa tu contraseña">
                                                </div>
                                                <div class="row px-3 mb-4">

                                                </div>
                                                <div class="col text-center">
                                                    <button class="btn btn-blue" id="btn-login" name="btn-login">Iniciar</button>
                                                </div>
                                            </form>
                            </div>

                        </div>
                    </div>




                    <!-- <div class="footer text-center">
        <small class="ml-4 ml-sm-4 mb-2"> BIPS Copyright &copy; 2021. All rights reserved.</small>
    </div>-->

                    <script>
                        $(document).ready(function() {

                            setTimeout(function() {
                                $('#notificacion_login').fadeOut('fast');
                            }, 5000);



                            $('#btn-cerrar-noti-login').click(function() {
                                $('#notificacion_login').attr("style", "display:none");

                            });

                        })


                        $('#btn-login').click(function(event) {



                            if ($('#username').val() == "" || $('#password').val() == "") {
                                alert("se deben ingresar los campos usuario y contraseña");
                                /*setTimeout(function () {
                                    window.location.reload(1);
                                }, 1000);*/

                            } else {


                                //const $form = document.querySelector('#form_login');
                                var user = $('#username').val();
                                var pass = $('#password').val();

                                $.ajax({
                                    type: 'post',
                                    url: '/login-data',
                                    async: false,
                                    data: {
                                        username: user,
                                        password: pass,
                                    },

                                    success: function(result) {


                                        $('#body').html(result);

                                        history.replaceState("/config-entidades", "Nueva Entidad Bips", "/config-entidades");

                                        setTimeout(function() {
                                            window.location.reload(1);
                                        }, 5000);



                                    }

                                });
                            }


                        });
                    </script>

                    <%- include("footer"); %>