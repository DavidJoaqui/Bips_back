<div style="display: flex;justify-content: center;align-items: center;padding-bottom: 30px">


    <div class="col-md-12 col-md-offset-12" style="padding-bottom: 30px">

        <div class="card border-dark container" style=" text-align: center;">

            <div class="preview text-center" id="preview" style="display: flex;justify-content: center;align-items: center; padding-top: 15px; padding-bottom: 15px;">
                <div class="card col-md-12" id="card-msg">


                </div>
            </div>

            <div class="col-md-12" style="text-align: center;">
                <h3 style="color: #20488f;font-size: 30px;font-weight: bold;" class="">Editar Registro Indicador.
                </h3>
            </div>

            <form id="formulario" enctype="multipart/form-data" method="">
                <% indicador_info.forEach(lista=> { %>
                    <div class="form-group row">

                        <label class="col-2 col-form-label" style="font-weight: bold;" for="select_objetivo">Area: </label>
                        <div class="col-3">
                            <input type="text" name="select_area" id="select_area" value="<%= lista.id_area %>" hidden>
                            <label type="text" name="select_area" id="select_area" value=" " disabled><%= lista.nombre_area %></label>
                        </div>

                        <label class="col-2 col-form-label" style="font-weight: bold;">
                        Profesional:</label>

                        <div class="col-5">
                            <p>
                                <input type="text" id="select_version" name="select_version" value="0" hidden>
                                <input type="text" id="id_registroindicador" name="id_registroindicador" value="<%= lista.id_registroindicador %>" hidden>
                                <input type="text" id="select_profesional" name="select_profesional" value="<%= lista.id_profesional %>" hidden>
                                <input type="text" id="vigencia_año" name="vigencia_año" value="<%= lista.vigencia %>" hidden>
                                <label type="text" name="" id="" value="" disabled> <%= lista.nombre_profesional%></label>

                            </p>


                            <!--    <select class="form-control" name="select_profesional" id="select_profesional" data-toggle="tooltip" title="Seleccionar Profesional!" data-placement="right" required>
                            <option selected="selected" value="">Seleccionar Profesional</option>



                        </select>-->
                        </div>



                    </div>

                    <div class="form-group row">
                        <label for="txt_onjetivo" class="col-2 col-form-label" style="font-weight: bold;">
                        Nombre Indicador: </label>
                        <div class="col-10">
                            <label type="text" name="" id="" value="" disabled> <%= lista.nombre_indicador%></label>
                        </div>
                    </div>

                    <div class="form-group row">

                        <label class="col-2 col-form-label" style="font-weight: bold;" for="select_vigencia">Vigencia: </label>
                        <div class="col-3">
                            <label type="text" name="" id="" value="" disabled> <%= lista.vigencia%></label>


                        </div>

                        <label class="col-2 col-form-label" style="font-weight: bold;">
                        Periodo Evaluado:</label>

                        <div class="col-5">
                            <label type="text" name="" id="" value="" disabled> <%= lista.nombre_mes%></label>

                        </div>
                    </div>


                    <div class="" id="contenedor_info_indicador" name="contenedor_info_indicador" hidden>

                        <div class="dropdown-divider"></div>

                        <div class="form-group row">
                            <label class="col-2 col-form-label" style="font-weight: bold;">
                        - </label>


                            <div class="col-10">
                                <h3 class="text-center col-12" id="titulo_info_indicador">Información del Indicador Seleccionado</h3>
                            </div>

                        </div>





                        <div class="form-group row" id="info_tipo_meta">
                            <label class="col-2 col-form-label" style="font-weight: bold;">
                            Tipo Meta: </label>
                            <div class="col-10">
                                <label type="text" name="" id="" value="" disabled> <%= lista.tipo_meta%></label>

                            </div>

                        </div>

                        <div class="container" id="panel_descriptiva" style=" text-align: center;">



                            <div class="form-group row">
                                <label class="col-2 col-form-label" for="txt_meta_descriptiva" style="font-weight: bold;">
                                Meta descriptiva: </label>
                                <div class="col-10">
                                    <label type="text" name="" id="" value="" disabled> <%= lista.meta_descriptiva%></label>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-2 col-form-label" for="txt_fl_descriptiva" style="font-weight: bold;">Descripcion: </label>
                                <div class="col-10">
                                    <label type="text" name="" id="" value="" disabled> <%= lista.formula_literal_descriptiva%></label>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-2 col-form-label" style="font-weight: bold;">
                            - </label>


                                <div class="col-10">
                                    <h3 class="text-center col-12">Ingreso de Registros.</h3>
                                </div>

                            </div>

                        </div>

                        <div class="container" id="panel_numerica" style=" text-align: center;">

                            <div class="form-group row">
                                <label class="col-2 col-form-label" for="txt_meta_numerica" style="font-weight: bold;">
                                Periodo Evaluación: </label>
                                <div class="col-10">
                                    <label type="text" name="" id="" value="" disabled> <%= lista.periodo_meta_num%></label>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-2 col-form-label" for="txt_meta_numerica" style="font-weight: bold;">
                                Meta Númerica: </label>
                                <div class="col-10">
                                    <label type="text" name="" id="" value="" disabled> <%= lista.periodo_meta_num%></label>
                                </div>

                            </div>

                            <div class="form-group row">
                                <label class="col-2 col-form-label" for="txt_fl_numerador" style="font-weight: bold;">
                                Numerador: </label>
                                <div class="col-10">
                                    <label type="text" name="" id="" value="" disabled> <%= lista.formula_literal_numerador%></label>
                                </div>
                            </div>


                            <div class="form-group row">
                                <label class="col-2 col-form-label" for="txt_fl_denominador" style="font-weight: bold;">
                                Denominador: </label>
                                <div class="col-10">
                                    <label type="text" name="" id="" value="" disabled> <%= lista.formula_literal_denominador%></label>
                                </div>

                            </div>

                            <div class="form-group row">
                                <label class="col-2 col-form-label" style="font-weight: bold;">
                            - </label>


                                <div class="col-10">
                                    <h3 class="text-center col-12">Ingreso de Registros.</h3>
                                </div>

                            </div>
                            <div class="form-group row">

                                <label class="col-2 col-form-label" style="font-weight: bold;"> Valor Numerador:
                            </label>

                                <div class="col-4">
                                    <input class="form-control" type="text" placeholder="Ingresar Valor" name="txt_vr_numerador" id="txt_vr_numerador" value="<%= lista.formula_cifras_numerador%>">
                                </div>
                                <label class="col-2 col-form-label" style="font-weight: bold;"> Valor Denominador:
                            </label>

                                <div class="col-4">
                                    <input class="form-control" type="text" placeholder="Ingresar Valor" name="txt_vr_denominador" id="txt_vr_denominador" value="<%= lista.formula_cifras_denominador%>">
                                </div>
                            </div>



                        </div>

                        <div class="form-group row" id="panel_observacion">
                            <label for="txt_observacion" class="col-2 col-form-label" style="font-weight: bold;">                                    
                                Observaciones: </label>

                            <div class="col-10">
                                <input class="form-control" type="text" name="txt_observacion" id="txt_observacion" value='<%= indicador_info[0].observaciones%>'></textarea>
                            </div>

                        </div>

                        <div class="form-group row" id="panel_soporte">
                            <label for="txt_soporte" class="col-2 col-form-label" style="font-weight: bold;">                                    
                            Anexar soporte: </label>

                            <div class="col-6">
                                <input type="file" class="input-file-input form-control" name="files_soporte" id="files_soporte" multiple>
                            </div>


                        </div>

                        <div class="form-group row">
                            <label for="panel_soportes" class="col-2 col-form-label" style="font-weight: bold;color: blue">
                                    Soportes: </label>
                            <div class="form-group row col-10" id="panel_soportes">

                            </div>
                        </div>

                        <div class="form-group col-sm-12" style="display: flex;justify-content: center;align-items: center;margin-top: 10px;">
                            <div class="text-center">
                                <button style="font-weight: bold;" class="btn btn-success" id="btn-guardar" name="btn-guardar" onclick="">Actualizar
                                Registro Indicador</button>
                                <a href="/ctm-reg-indicadores" class="btn btn-secondary ; " id="btn-volver" name="btn-volver">volver</a>

                            </div>
                        </div>

                        <% }); %>

            </form>

            </div>
        </div>
    </div>





    <script type="text/javascript">
        $(document).ready(function() {

            $('#contenedor_info_indicador').attr('hidden', false);

            if ('<%= indicador_info[0].tipo_meta%>' == "Descriptiva") {
                $('#panel_numerica').attr('hidden', true);
                $('#panel_descriptiva').attr('hidden', false);


            } else {
                $('#panel_numerica').attr('hidden', false);
                $('#panel_descriptiva').attr('hidden', true);


            }

            var peticion_soportes = "/obtener_soportesxreg_indicador/?id_reg_indicador=<%= indicador_info[0].id_registroindicador %>";
            $.ajax({
                type: 'get',
                url: peticion_soportes,
                data: [],
                contentType: false,
                cache: false,
                processData: false,
                success: function(result) {
                    $("#panel_soportes").html("");
                    //$("#select_indicador").append('<option selected="selected">' + 'Seleccionar Indicador' + '</option>');
                    $("#panel_soportes").html(result);

                }
            });

            const $form = document.querySelector('#formulario');


            $form.addEventListener('submit', (event) => {

                event.preventDefault();

                $.ajax({
                    type: 'POST',
                    url: '/actualizar-reg-indicador',
                    data: new FormData($form),
                    contentType: false,
                    cache: false,
                    processData: false,

                    beforeSend: function(data) {
                        //console.log(data.status + ':' + data.statusText,data.responseText);

                    },
                    error: function(data) {

                        console.log(data.responseText);
                        //var err = data.responseText.slice(0, 9);



                        //$('#formulario')[0].reset();

                    },
                    success: function(result) {


                        //$('#datos').html('');
                        //$('#btn-subir').attr("disabled", true);
                        if (result['status'] == 200) {
                            //console.log(JSON.stringify(result['respuesta']));

                            const $file_ = document.querySelector('#files_soporte');
                            $file_.value = '';

                            alert("Se actualizo el registro indicador Correctamente");

                            var peticion_soportes = "/obtener_soportesxreg_indicador/?id_reg_indicador=<%= indicador_info[0].id_registroindicador %>";
                            $.ajax({
                                type: 'get',
                                url: peticion_soportes,
                                data: [],
                                contentType: false,
                                cache: false,
                                processData: false,
                                success: function(result) {
                                    $("#panel_soportes").html("");
                                    //$("#select_indicador").append('<option selected="selected">' + 'Seleccionar Indicador' + '</option>');
                                    $("#panel_soportes").html(result);

                                }
                            });

                            //$('#formulario')[0].reset();








                        } else {
                            alert("ocurrio un error...");
                        }

                    }

                });

            });



        });
    </script>